
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lovable App</title>
    <!-- Tactical Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&family=Orbitron:wght@200;300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#0f0f23" />
    
    <!-- SISTEMA DE SIMULAÃ‡ÃƒO TEMPORAL SIMPLIFICADO -->
    <script>
      console.log('ğŸš€ ===== INICIALIZANDO testSimulation LIMPO =====');
      
      // FunÃ§Ã£o para obter dados do localStorage (somente leitura)
      const getSimulatedDateData = () => {
        const simulatedDate = localStorage.getItem('simulatedDate');
        const simulatedStreak = localStorage.getItem('simulatedStreak');
        const isSimulating = !!simulatedDate;
        
        const getCurrentDateString = () => {
          return simulatedDate ? new Date(simulatedDate).toDateString() : new Date().toDateString();
        };

        return {
          getCurrentDateString,
          simulatedStreak: simulatedStreak ? parseInt(simulatedStreak) : 0,
          isSimulating,
          simulatedDate
        };
      };

      // Definir testSimulation globalmente - APENAS EVENTOS
      window.testSimulation = {
        advanceDay: () => {
          console.log('ğŸ® Disparando evento ADVANCE_DAY para o React');
          window.dispatchEvent(new CustomEvent('simulation-event', { 
            detail: { type: 'ADVANCE_DAY' } 
          }));
        },
        
        goBackDay: () => {
          console.log('ğŸ® Disparando evento GO_BACK_DAY para o React');
          window.dispatchEvent(new CustomEvent('simulation-event', { 
            detail: { type: 'GO_BACK_DAY' } 
          }));
        },
        
        skipDay: () => {
          console.log('ğŸ® Disparando evento SKIP_DAY para o React');
          window.dispatchEvent(new CustomEvent('simulation-event', { 
            detail: { type: 'SKIP_DAY' } 
          }));
        },
        
        reset: () => {
          console.log('ğŸ® Disparando evento RESET_SIMULATION para o React');
          window.dispatchEvent(new CustomEvent('simulation-event', { 
            detail: { type: 'RESET_SIMULATION' } 
          }));
        },
        
        addShields: (amount = 1) => {
          console.log(`ğŸ›¡ï¸ Disparando evento ADD_SHIELDS (${amount}) para o React`);
          window.dispatchEvent(new CustomEvent('simulation-event', { 
            detail: { type: 'ADD_SHIELDS', payload: { amount } } 
          }));
        },
        
        status: () => {
          console.log('ğŸ® ===== STATUS DA SIMULAÃ‡ÃƒO (SOMENTE LEITURA) =====');
          
          const { getCurrentDateString, simulatedStreak, isSimulating } = getSimulatedDateData();
          
          const storedProgress = localStorage.getItem('userProgress');
          const progress = storedProgress ? JSON.parse(storedProgress) : null;
          const shields = progress?.streakProtectionShields || 0;
          const realLoginStreak = progress?.loginStreak || 0;
          
          console.log(`ğŸ“Š INFORMAÃ‡Ã•ES GERAIS:`);
          console.log(`ğŸ“… Data atual: ${getCurrentDateString()}`);
          console.log(`ğŸ”¥ Login Streak (simulado): ${simulatedStreak}`);
          console.log(`ğŸ”¥ Login Streak (real no estado): ${realLoginStreak}`);
          console.log(`ğŸ›¡ï¸ Escudos de proteÃ§Ã£o: ${shields}`);
          console.log(`ğŸ® Modo simulaÃ§Ã£o: ${isSimulating ? 'ATIVO' : 'INATIVO'}`);
          console.log(`ğŸ¯ PrÃ³ximo escudo em: ${7 - (simulatedStreak % 7)} dia(s)`);
          
          // Calcular multiplicadores
          const cycleStreakBonus = Math.min((progress?.cycleStreak || 0) * 0.1, 0.4);
          const loginStreakBonus = Math.min(Math.floor(simulatedStreak / 3) * 0.05, 0.25);
          
          console.log(`ğŸ“ˆ MULTIPLICADORES:`);
          console.log(`ğŸ¯ Cycle Streak Bonus: +${Math.round(cycleStreakBonus * 100)}% XP`);
          console.log(`ğŸ”¥ Login Streak Bonus: +${Math.round(loginStreakBonus * 100)}% XP`);
          
          console.log('ğŸ® ===== FIM STATUS =====');
          
          return {
            date: getCurrentDateString(),
            streak: simulatedStreak,
            realStreak: realLoginStreak,
            shields: shields,
            simulating: isSimulating,
            nextShieldIn: 7 - (simulatedStreak % 7),
            cycleStreakBonus: Math.round(cycleStreakBonus * 100),
            loginStreakBonus: Math.round(loginStreakBonus * 100)
          };
        },
        
        reload: () => {
          console.log('ğŸ”„ ===== RECARREGANDO PÃGINA =====');
          window.location.reload();
        },
        
        help: () => {
          console.log(`
ğŸ® ===== COMANDOS DE SIMULAÃ‡ÃƒO TEMPORAL (VERSÃƒO LIMPA) =====

COMANDOS BÃSICOS (Agora controlados pelo React):
testSimulation.advanceDay()     - AvanÃ§a 1 dia (React gerencia estado)
testSimulation.goBackDay()      - Volta 1 dia (React gerencia estado)  
testSimulation.skipDay()        - Pula 1 dia (React gerencia escudos/penalidades)
testSimulation.reset()          - Volta para data real (React gerencia)
testSimulation.addShields(N)    - Adiciona N escudos (React gerencia)

COMANDOS DE CONSULTA (Somente leitura):
testSimulation.status()         - Mostra status completo
testSimulation.help()           - Mostra esta ajuda
testSimulation.reload()         - Recarrega pÃ¡gina manualmente

MELHORIAS DA VERSÃƒO LIMPA:
âœ… React controla 100% do estado
âœ… Sem conflitos localStorage vs React
âœ… Sem recarregamentos automÃ¡ticos
âœ… Estado sempre consistente
âœ… Sem "guerra" entre sistemas

SISTEMA DE ESCUDOS (Gerenciado pelo React):
ğŸ›¡ï¸ Ganha escudo a cada 7 dias de streak
ğŸ›¡ï¸ Escudo protege contra penalidade de skip
ğŸ›¡ï¸ Skip sem escudo = -3 streak
ğŸ›¡ï¸ Skip com escudo = streak protegida + consome 1 escudo

ğŸ® ===== VERSÃƒO LIMPA ATIVA! =====
          `);
        }
      };

      console.log('âœ… testSimulation LIMPO definido globalmente!');
      console.log('ğŸ¯ Digite no console: testSimulation.help()');
      console.log('ğŸ“Š Digite no console: testSimulation.status()');
      console.log('ğŸš€ ===== SISTEMA LIMPO PRONTO! =====');
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
